
# üîê HTTP Security Response Headers

**HTTP Security Response Headers** are special instructions sent by a web server to a client (like a browser) to improve security and reduce the risk of common attacks such as:

* Cross-Site Scripting (XSS)
* Clickjacking
* MIME-type sniffing
* Data leakage

> üìö **Reference:** [OWASP HTTP Headers Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html)

---

## üìã Common Security Headers

### 1. `Strict-Transport-Security (HSTS)`

```http
Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
```

* Forces the browser to use **HTTPS only**
* Prevents **protocol downgrade** and **MITM (Man-In-The-Middle)** attacks
* `max-age`: Duration in seconds (e.g., 1 year = 31536000)
* `includeSubDomains`: Applies the rule to all subdomains
* `preload`: Requests inclusion in browser preload lists

---

### 2. `X-Content-Type-Options`

```http
X-Content-Type-Options: nosniff
```

* Prevents **MIME-type sniffing**
* Ensures the browser uses the declared `Content-Type` header

---

### 3. `X-Frame-Options`

```http
X-Frame-Options: DENY
```

* Protects against **clickjacking**
* Options:

  * `DENY`: Disallows all framing
  * `SAMEORIGIN`: Allows only same-origin pages to embed the content
  * `ALLOW-FROM uri`: Deprecated, used to allow a specific domain

---

### 4. `Content-Security-Policy (CSP)`

```http
Content-Security-Policy: default-src 'self'; script-src 'self' https://apis.example.com
```

* Prevents **XSS**, code injection, and data exfiltration
* Controls which sources the browser can load content from
* Common directives:

  * `default-src`, `script-src`, `style-src`, `img-src`, etc.

---

### 5. `X-XSS-Protection` (Deprecated)

```http
X-XSS-Protection: 1; mode=block
```

* Enables browser‚Äôs **XSS filter**
* Mostly deprecated; modern CSP implementations are preferred
* **‚ö†Ô∏è Chrome and other browsers no longer support this header**

---

### 6. `X-Content-Security-Policy` / `X-WebKit-CSP`

```http
X-Content-Security-Policy: default-src 'self'
```

* **Legacy headers** for older browsers (Firefox, WebKit)
* Replaced by modern `Content-Security-Policy`

---

### 7. `Referrer-Policy`

```http
Referrer-Policy: no-referrer
```

* Controls how much **referrer information** is sent
* Common values:

  * `no-referrer`, `origin`, `same-origin`, `strict-origin`, etc.
* Improves **user privacy**

---

### 8. `Permissions-Policy` (formerly `Feature-Policy`)

```http
Permissions-Policy: geolocation=(), microphone=()
```

* Restricts access to **powerful browser features**
* Controls:

  * `geolocation`, `camera`, `microphone`, `payment`, etc.
* Helps reduce **attack surface**

---

## secure-headers.php
secure-headers.php

```php

<?php
// Set essential security headers
header("Strict-Transport-Security: max-age=31536000; includeSubDomains; preload");
header("X-Content-Type-Options: nosniff");
header("X-Frame-Options: DENY");
header("Content-Security-Policy: default-src 'self'");
header("X-XSS-Protection: 1; mode=block");
header("Referrer-Policy: no-referrer");
header("Permissions-Policy: geolocation=(), microphone=()");
?>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Secure Headers Test</title>
</head>
<body>
  <h1>‚úî Security Headers Sent</h1>
  <p>Use your browser's developer tools (Network tab) to inspect the response headers.</p>
</body>
</html>

```

---

## üß™ How to Test

1. **Save the file** as `secure_headers.php`.
2. **Run it in your browser** through your local server, e.g.:
   [http://localhost/secure\_headers.php](http://localhost/secure_headers.php)
3. **Open Developer Tools** (press `F12` or right-click ‚Üí *Inspect*)
   Go to the **Network** tab, then click on the `secure_headers.php` request.
4. **Check the ‚ÄúHeaders‚Äù section**:
   Under **Response Headers**, verify that all the security headers you defined (e.g., `Strict-Transport-Security`, `X-Content-Type-Options`, etc.) are present.

---

## ‚úÖ Best Practices

* [**Always use HTTPS**](https://developer.mozilla.org/en-US/docs/Web/Security/HTTP_strict_transport_security) along with [**HSTS**](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security)
* [**Use a strong Content-Security-Policy**](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP)
* [**Avoid deprecated headers** like `X-XSS-Protection`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection)
* [**Periodically audit headers**](https://owasp.org/www-project-secure-headers/) for updates based on evolving browser standards


---

