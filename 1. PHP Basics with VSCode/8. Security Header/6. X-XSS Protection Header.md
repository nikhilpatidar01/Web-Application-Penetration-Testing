
# üõ°Ô∏è X-XSS-Protection Header ‚Äì PHP Security Lab

## üîç What is `X-XSS-Protection`?

The `X-XSS-Protection` HTTP header enables the browser‚Äôs built-in **Cross-Site Scripting (XSS)** protection mechanism. It tells the browser to detect reflected XSS attacks and take action‚Äîtypically blocking or sanitizing the response.

---

## üîß Header Syntax

```php
<?php
header('X-XSS-Protection: 1; mode=block');
?>
```

### üîé Header Breakdown

| Directive    | Description                                                                  |
| ------------ | ---------------------------------------------------------------------------- |
| `1`          | Enables the XSS protection mechanism                                         |
| `mode=block` | Instructs the browser to **block the response** if an XSS attack is detected |

---

## ‚ö†Ô∏è Important Notes

* `X-XSS-Protection` is **deprecated** in modern browsers (Chrome 78+, Edge).
* It is **still supported in Internet Explorer**, older Chrome, and Safari versions.
* Use **Content-Security-Policy (CSP)** instead for modern, robust protection.

---

## üß™ Testing with `curl`

Use the following command to test if the header is present:

```ini
curl -I https://yourdomain.com/xss_protection.php
```

**Expected Output:**

```
X-XSS-Protection: 1; mode=block
```

---

## üß™ XSS Protection Lab Files

### 1Ô∏è‚É£ `xss_protection_on.php` ‚Äì XSS Protection Enabled

```ini
 <?php
// Enable legacy XSS protection
// header('X-XSS-Protection: 1; mode=block');
header("Content-Security-Policy: default-src 'self'; script-src 'self';");

?>
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>XSS Protection ON</title>
</head>
<body>
    <h2>XSS Protection: ON</h2>
    <form method="GET">
        <label for="input">Enter something:</label>
        <input type="text" name="input" id="input">
        <input type="submit" value="Submit">
    </form>
    <hr>
    <p>Output:</p>
    <div>
        <?php
        if (isset($_GET['input'])) {
            echo $_GET['input']; // Vulnerable: No sanitization
        }
        ?>
    </div>
</body>
</html>
```

---

### 2Ô∏è‚É£ `xss_protection_with_csp.php` ‚Äì Modern Protection with CSP

```ini
<?php
// Enable CSP for modern browsers
header("Content-Security-Policy: default-src 'self'; script-src 'self'");
?>
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>XSS Protection with CSP</title>
</head>
<body>
    <h2>XSS Protection: CSP Enabled</h2>
    <form method="GET">
        <label for="input">Enter something:</label>
        <input type="text" name="input" id="input">
        <input type="submit" value="Submit">
    </form>
    <hr>
    <p>Output:</p>
    <div>
        <?php
        if (isset($_GET['input'])) {
            echo $_GET['input']; // Vulnerable: No sanitization
        }
        ?>
    </div>
</body>
</html>
```

---

### 3Ô∏è‚É£ `xss_protection_off.php` ‚Äì XSS Protection Disabled

```ini
<?php
// Explicitly disable XSS protection
header('X-XSS-Protection: 0');
?>
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>XSS Protection OFF</title>
</head>
<body>
    <h2>XSS Protection: OFF</h2>
    <form method="GET">
        <label for="input">Enter something:</label>
        <input type="text" name="input" id="input">
        <input type="submit" value="Submit">
    </form>
    <hr>
    <p>Output:</p>
    <div>
        <?php
        if (isset($_GET['input'])) {
            echo $_GET['input']; // Vulnerable: No sanitization
        }
        ?>
    </div>
</body>
</html>
```

---

## üß™ Test Input (Simulated Attack)

Paste this payload into the input field of each file:

```html
<script>alert('XSS')</script>
```

---

## ‚úÖ Expected Behavior Summary

| File                          | Protection Mechanism    | Expected Result                                                |
| ----------------------------- | ----------------------- | -------------------------------------------------------------- |
| `xss_protection_on.php`       | X-XSS-Protection        | XSS is **blocked** in older browsers                           |
| `xss_protection_off.php`      | Disabled Protection     | XSS **executes** if the browser doesn‚Äôt block it automatically |
| `xss_protection_with_csp.php` | Content-Security-Policy | XSS **blocked** in modern browsers via CSP                     |

---

