# $_SESSION
# ‚úÖ PHP `$_SESSION` ‚Äî Superglobal

PHP sessions allow you to store **user-specific data** on the **server**, making them ideal for login systems, shopping carts, and more.

---

## ‚úÖ Advantages of `$_SESSION`

| Benefit          | Description                                                    |
| ---------------- | -------------------------------------------------------------- |
| More Storage     | Stores more data than cookies (not limited to \~4 KB)          |
| Smaller Requests | Data is not sent with each HTTP request like cookies           |
| More Secure      | Stored server-side, not exposed to users                       |
| Data Concealment | Users cannot view or manipulate session data via browser tools |

---

## ‚ùå Disadvantages of `$_SESSION`

| Limitation         | Description                                                 |
| ------------------ | ----------------------------------------------------------- |
| Slightly Slower    | Involves file system access on the server                   |
| Session File Bloat | Sessions create files that can build up over time           |
| Session Timeout    | Sessions expire if the user is inactive for too long        |
| Requires Storage   | Needs writable directory for storing session data on server |

---

## üîß Session Operations

> üî∏ Always call `session_start()` before any HTML output.

### 1. Start a Session

```php
session_start(); // Must be at the top of your script
```

### 2. Set a Session Variable

```php
$_SESSION["username"] = "admin";
```

### 3. Get a Session Variable

```php
echo $_SESSION["username"];
```

### 4. Update a Session Variable

```php
$_SESSION["username"] = "newadmin";
```

### 5. Delete a Single Session Variable

```php
unset($_SESSION["username"]);
```

### 6. Remove All Session Variables

```php
session_unset(); // Clears all session data; session still exists
```

### 7. Destroy the Session

```php
session_destroy(); // Deletes session data and removes session cookie
```

---

## üîê Session Security Tips

* Use `session_regenerate_id(true)` after login to prevent session fixation.
* Set session timeout using:

  ```php
  ini_set('session.gc_maxlifetime', 1800);
  ```
* Use HTTPS and `session.cookie_secure = 1` in production.
* Restrict JavaScript access with `session.cookie_httponly = 1`.

---

## üìÅ Notes on Session Storage

* Each session file is named using the session ID: `sess_<session_id>`
* To view session save path:

  ```bash
  php -i | grep session.save_path
  ```
* You can also check/set it in your `php.ini`:

  ```ini
  session.save_path = "/var/lib/php/sessions"
  ```
* To verify current value via CLI:

  ```bash
  cat /etc/php/8.2/apache2/php.ini | grep session.save_path
  ```

---

## üßπ Managing Session Files

* Ensure your web server user has read/write permissions to the session save directory.
* Clean up old session files using `session.gc_maxlifetime` and garbage collection.
* For large-scale applications, consider alternative storages like:

  * Redis
  * Memcached
  * Database

---

# üìÅ PHP Session Examples

---

### 1. `sessions.php` ‚Äî Create and Set Session Variables

```php
<?php
session_start();
$_SESSION['first_name'] = 'Rahul';
$_SESSION['last_name'] = 'Jain';
?>
<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
  <title>Sessions</title>
</head>
<body>
  <pre><?php print_r($_SESSION); ?></pre>
  <?php
    $fullname = $_SESSION['first_name'] . " " . $_SESSION['last_name'];
    echo $fullname;
  ?>
</body>
</html>
```

---

### 2. üìÅ Session File Location on Linux

Typical locations:

* `/var/lib/php/sessions/sess_[PHPSESSID]` (Modern versions)
* `/var/lib/php5/sessions/sess_[PHPSESSID]` (PHP 5.x)
* `/var/lib/php/sess_[PHPSESSID]`

---

### 3. `view-sessions.php` ‚Äî Access Session Variables

```php
<?php
session_start();
?>
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>View Sessions</title>
</head>
<body>
  <?php
    echo $_SESSION['first_name'] . " " . $_SESSION['last_name'];
  ?>
</body>
</html>
```

---

### 4. `view_sessions2.php` ‚Äî Check if Session Variables Exist

```php
<?php
session_start();
?>
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>View Sessions</title>
</head>
<body>
  <?php
  if (isset($_SESSION['first_name']) && isset($_SESSION['last_name'])) {
    echo $_SESSION['first_name'] . " " . $_SESSION['last_name'];
  } else {
    echo "Session variables are not set.";
  }
  ?>
</body>
</html>
```

---

### 5. `updating-session.php` ‚Äî Update Session Variables

```php
<?php
session_start();
?>
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Updating Session</title>
</head>
<body>
  <?php
    $_SESSION['first_name'] = "Ankit";
    $_SESSION['last_name'] = "Sharma";

    if (isset($_SESSION['first_name']) && isset($_SESSION['last_name'])) {
      echo $_SESSION['first_name'] . " " . $_SESSION['last_name'];
    }
  ?>
</body>
</html>
```

---

### 6. `deleting_session.php` ‚Äî Delete Specific Session Variables

```php
<?php
session_start();
unset($_SESSION['first_name']);
unset($_SESSION['last_name']);
?>
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Deleting Session</title>
</head>
<body>
  <?php
  if (isset($_SESSION['first_name']) && isset($_SESSION['last_name'])) {
    echo $_SESSION['first_name'] . " " . $_SESSION['last_name'];
  } else {
    echo "Session variables deleted.";
  }
  ?>
</body>
</html>
```

---

### 7. `deleting_session2.php` ‚Äî Remove All Session Variables

```php
<?php
session_start();
session_unset(); // Clears all session variables
?>
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Remove All Session Variables</title>
</head>
<body>
  <?php
  if (isset($_SESSION['first_name']) && isset($_SESSION['last_name'])) {
    echo $_SESSION['first_name'] . " " . $_SESSION['last_name'];
  } else {
    echo "All session variables removed.";
  }
  ?>
</body>
</html>
```

---

### 8. `destroy-session.php` ‚Äî Destroy the Entire Session

```php
<?php
session_start();
session_destroy(); // Ends the session and deletes session data
?>
<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
  <title>Destroy Session</title>
</head>
<body>
  <?php echo "Session destroyed."; ?>
</body>
</html>
```

---
üìñ Reference: Notes inspired by guidance from Mr. Sachin Verma Sir ([Armour Infosec](https://www.armourinfosec.com/)) and enriched with further improvements and updates.
