
# Hashing in PHP

Hashing is a **one-way process** to convert any input into a fixed-size string of characters, which appears random.
It's commonly used to store passwords securely.
**Note:** MD5 and SHA1 are outdated and not secure for password storage but useful for learning.

### PHP Hash Functions

| Function                                                             | Description                                  | Output                                                          |
| -------------------------------------------------------------------- | -------------------------------------------- | --------------------------------------------------------------- |
| `md5(string $str, bool $raw_output = false): string`                 | Calculates MD5 hash                          | 32-char hex by default, or 16-byte binary if `$raw_output=true` |
| `sha1(string $str, bool $raw_output = false): string`                | Calculates SHA1 hash                         | 40-char hex by default, or 20-byte binary if `$raw_output=true` |
| `hash(string $algo, string $data, bool $raw_output = false): string` | Supports many algorithms like sha256, sha512 | Varies by algorithm                                             |

---

# Example: MD5 and SHA1 Hashing in PHP

```php
<?php
$str = "Armour Infosec";

echo "Original String: " . $str . "<br /><br />";

// MD5 Hashing
echo "MD5 HEX: " . md5($str) . "<br />";
echo "MD5 Binary (raw output): " . md5($str, true) . "<br />";
echo "Double MD5 (md5(md5(str))): " . md5(md5($str)) . "<br /><br />";

// SHA1 Hashing
echo "SHA1 HEX: " . sha1($str) . "<br />";
echo "SHA1 Binary (raw output): " . sha1($str, true) . "<br />";
echo "Double SHA1 (sha1(sha1(str))): " . sha1(sha1($str)) . "<br />";
?>
```

---

# Progressive Login Examples Using Different Hashing Methods

---

### 1. Plaintext Login (No security - NEVER use in production)

**login1.php**

```html
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Login 1 - Plaintext</title>
</head>
<body>
<form action="login1-check.php" method="POST">
Username: <input type="text" name="username" /><br />
Password: <input type="password" name="password" /><br />
<input type="submit" name="submit" value="Login" />
</form>
</body>
</html>
```

**login1-check.php**

```php
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Login Check</title>
</head>
<body>
<?php
if (isset($_POST['submit'])) {
    $username = $_POST['username'];
    $password = $_POST['password'];

    // WARNING: Plaintext check, NOT secure
    if ($username == "admin" && $password == "12345") {
        echo "You are logging in: {$username}";
    } else {
        echo "Incorrect username or password";
    }
} else {
    echo "Please log in";
}
?>
</body>
</html>
```

---

### 2. Base64 Encoding (Not secure, reversible)

**login2.php**

```html
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Login 2 - Base64 Encoding</title>
</head>
<body>
<form action="login2-check.php" method="POST">
Username: <input type="text" name="username" /><br />
Password: <input type="password" name="password" /><br />
<input type="submit" name="submit" value="Login" />
</form>
</body>
</html>
```

**login2-check.php**

```php
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Login Check</title>
</head>
<body>
<?php
if (isset($_POST['submit'])) {
    $username = $_POST['username'];
    $password = $_POST['password'];

    // Base64 encoding of "12345" is "MTIzNDU="
    if ($username == "admin" && base64_encode($password) == "MTIzNDU=") {
        echo "You are logging in: {$username}";
    } else {
        echo "Incorrect username or password";
    }
} else {
    echo "Please log in";
}
?>
</body>
</html>
```

---

### 3. MD5 Hashing (Weak, NOT recommended for production)

**login3.php**

```html
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Login 3 - MD5 Hashing</title>
</head>
<body>
<form action="login-check-3.php" method="POST">
Username: <input type="text" name="username" /><br />
Password: <input type="password" name="password" /><br />
<input type="submit" name="submit" value="Login" />
</form>
</body>
</html>
```

**login-check-3.php**

```php
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Login Check</title>
</head>
<body>
<?php
if (isset($_POST['submit'])) {
    $username = $_POST['username'];
    $password = $_POST['password'];

    // MD5 hash of "12345" is "827ccb0eea8a706c4c34a16891f84e7b"
    if ($username == "admin" && md5($password) == "827ccb0eea8a706c4c34a16891f84e7b") {
        echo "You are logging in: {$username}";
    } else {
        echo "Incorrect username or password";
    }
} else {
    echo "Please log in";
}
?>
</body>
</html>
```

---

### 4. Double MD5 Hashing (Slightly better but still weak)

**login4.php**

```html
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Login 4 - Double MD5 Hashing</title>
</head>
<body>
<form action="login-check-4.php" method="POST">
Username: <input type="text" name="username" /><br />
Password: <input type="password" name="password" /><br />
<input type="submit" name="submit" value="Login" />
</form>
</body>
</html>
```

**login-check-4.php**

```php
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Login Check</title>
</head>
<body>
<?php
if (isset($_POST['submit'])) {
    $username = $_POST['username'];
    $password = $_POST['password'];

    // Double MD5 hash of "12345" is md5(md5("12345")) = "1f32aa4c5a1d2ea010adcf2348166a04"
    if ($username == "admin" && md5(md5($password)) == "1f32aa4c5a1d2ea010adcf2348166a04") {
        echo "You are logging in: {$username}";
    } else {
        echo "Incorrect username or password";
    }
} else {
    echo "Please log in";
}
?>
</body>
</html>
```

---

### 5. Salted SHA512 Hashing (Much stronger, recommended)

**login5.php**

```html
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Login 5 - Salted SHA512 Hashing</title>
</head>
<body>
<form action="login-check-5.php" method="POST">
Username: <input type="text" name="username" /><br />
Password: <input type="password" name="password" /><br />
<input type="submit" name="submit" value="Login" />
</form>
</body>
</html>
```

**login-check-5.php**

```php
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Login Check</title>
</head>
<body>
<?php
if (isset($_POST['submit'])) {
    $username = $_POST['username'];
    $password = $_POST['password'];

    $salt = "x:afj4rz}ZAJjE5";
    $hash_pass = hash("sha512", md5($salt . $password . $salt));

    $correct_hash = "f7a6335df98d2f44484dfa7cf5cc5d8af444186f9b84ec0ff4575b89025137eeed269f909688460e242060bbc41d071673c02995d5a96434d3364782b2157cc3";

    if ($username == "admin" && $hash_pass === $correct_hash) {
        echo "You are logging in: {$username}";
    } else {
        echo "Incorrect username or password";
    }
} else {
    echo "Please log in";
}
?>
</body>
</html>
```

---

# Notes on Password Hashing Security

* **Avoid MD5 and SHA1 for password hashing in production**: They are fast and vulnerable to brute-force attacks.
* Use **PHP's `password_hash()` and `password_verify()`** (available since PHP 5.5): These use strong algorithms like bcrypt and manage salts automatically.
* Always use **salts** to prevent rainbow table attacks.
* Prefer slow hashing algorithms like **bcrypt, Argon2**, which are designed for secure password storage.

---

# User Registration: Hash the password securely

**user-registration.php**

```php
<?php
// Normally during registration
$password_plain = "12345"; // e.g. from registration form

// Hash the password securely with bcrypt
$hashed_password = password_hash($password_plain, PASSWORD_DEFAULT);

echo "Hashed password (store this in DB):<br />" . $hashed_password;
?>
```

**Example output:**

```
$2y$10$PqXIfMZ.BYndTo.C2kaeOBHlsRslIsW6PWhE4EuEXB4EOl-l3lLrCS
```

The **salt is included inside the hash**, so no need to store it separately.

---

# Login Check with `password_verify()`

**user-login-check.php**

```php
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Login Check</title>
</head>
<body>
<?php
if (isset($_POST['submit'])) {
    $username = $_POST['username'];
    $password = $_POST['password'];

    // Example hashed password fetched from DB for user "admin"
    $stored_hash = '$2y$10$PqXIfMZ.BYndTo.C2kaeOBHlsRslIsW6PWhE4EuEXB4EOl-l3lLrCS';

    if ($username == "admin" && password_verify($password, $stored_hash)) {
        echo "You are logging in: {$username}";
    } else {
        echo "Incorrect username or password";
    }
} else {
    echo "Please log in";
}
?>
</body>
</html>
```

---

# Summary

| Method                                  | Security Level    | Use in Production?           |
| --------------------------------------- | ----------------- | ---------------------------- |
| Plaintext                               | None              | NO                           |
| Base64 Encoding                         | None (reversible) | NO                           |
| MD5                                     | Weak              | NO                           |
| Double MD5                              | Slightly better   | NO                           |
| Salted SHA512                           | Strong            | Better, but bcrypt preferred |
| `password_hash()` + `password_verify()` | Very Strong       | YES (Recommended)            |

---

