
# Encode and Decode in PHP (HTML Encoding Functions)

When working with HTML output, encoding special characters is essential to prevent issues like broken HTML or security vulnerabilities such as **Cross-Site Scripting (XSS)**. PHP provides several functions to encode and decode HTML entities.

---

## 1. `htmlentities()`

### Purpose:

Converts **all applicable characters** to their corresponding **HTML entities**. This includes characters like `<`, `>`, `&`, quotes, accented characters, currency symbols, etc.

### Syntax:

```php
string htmlentities(
    string $string,
    int $flags = ENT_COMPAT | ENT_HTML401,
    ?string $encoding = null,
    bool $double_encode = true
)
```

### Parameters:

* **\$string** : Input string to encode.
* **\$flags** : Controls how to handle quotes and the document type (see table below).
* **\$encoding** : Character encoding (default is UTF-8 if PHP ≥ 5.4).
* **\$double\_encode** : Whether to encode existing entities again (default is `true`).

### Common Flags:

| Flag           | Description                           |
| -------------- | ------------------------------------- |
| `ENT_COMPAT`   | Encodes only double quotes            |
| `ENT_QUOTES`   | Encodes both single and double quotes |
| `ENT_NOQUOTES` | Does not encode any quotes            |
| `ENT_HTML401`  | Handle as HTML 4.01                   |
| `ENT_HTML5`    | Handle as HTML5                       |
| `ENT_XML1`     | Handle as XML 1                       |
| `ENT_XHTML`    | Handle as XHTML                       |

### Example:

```php
<?php
$str = "This is a & \"quoted\" text.";
echo htmlentities($str, ENT_QUOTES, 'UTF-8');
?>
```

**Output:**

```
This is a &amp; &quot;quoted&quot; text.
```

---

## 2. `htmlspecialchars()`

### Purpose:

Encodes **only special HTML characters** (`&`, `<`, `>`, `"`, `'`). It does **not** encode accented or other non-HTML special characters.

### Syntax:

```php
string htmlspecialchars(
    string $string,
    int $flags = ENT_COMPAT,
    ?string $encoding = null,
    bool $double_encode = true
)
```

### Example:

```php
<?php
$str = "Café & Restaurant \"24/7\"";
echo htmlspecialchars($str, ENT_QUOTES, 'UTF-8');
?>
```

**Output:**

```
Café &amp; Restaurant &quot;24/7&quot;
```

---

## Key Differences: `htmlentities()` vs `htmlspecialchars()`

| Feature            | `htmlspecialchars()`                                   | `htmlentities()`                                          |
| ------------------ | ------------------------------------------------------ | --------------------------------------------------------- |
| Characters encoded | Only special HTML characters (`<`, `>`, `&`, `'`, `"`) | All characters with HTML entity equivalents               |
| Usage              | Safely display user input in HTML                      | Encode full HTML (e.g. to display code samples)           |
| Output readability | More readable                                          | Less readable (many characters are converted to entities) |
| Performance        | Slightly faster                                        | Slightly slower                                           |

---

## Practical Advice

* ✅ Use `htmlspecialchars()` in most cases to **safely display user-generated content** on web pages.
* ✅ Use `htmlentities()` when you need to **fully escape** content (e.g., displaying code as text or legacy documents).
* ✅ Always specify the encoding (preferably `'UTF-8'`) to avoid encoding issues.
* ❌ Avoid double-encoding by setting `$double_encode = false` if needed.

---

## Example Code Comparison

```php
<?php
$text = "Café & Restaurant \"24/7\"";

// htmlspecialchars example
echo "htmlspecialchars output:<br>";
echo htmlspecialchars($text, ENT_QUOTES, 'UTF-8');
echo "<br><br>";

// htmlentities example
echo "htmlentities output:<br>";
echo htmlentities($text, ENT_QUOTES, 'UTF-8');
?>
```

**Output:**

```
htmlspecialchars output:
Café &amp; Restaurant &quot;24/7&quot;

htmlentities output:
Caf&eacute; &amp; Restaurant &quot;24/7&quot;
```

---

## htmlentities.php (Full HTML Example)

```php
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>htmlentities Example</title>
</head>
<body>
<?php
$str = "We are <a href='https://www.armourinfosec.com/'>Armour Infosec</a>. A knowledge-based and technical security solutions provider, offering <b>Ethical Hacking & Cyber Security</b> courses.";

// Original string (HTML will be rendered)
echo "Original string:<br>" . $str . "<br><br>";

// htmlentities - convert everything
$encoded = htmlentities($str, ENT_QUOTES, 'UTF-8');
echo "After htmlentities (encoded):<br>" . $encoded . "<br><br>";

// Decode back to original
echo "After html_entity_decode:<br>" . html_entity_decode($encoded, ENT_QUOTES, 'UTF-8');
?>
</body>
</html>
```

---

## htmlspecialchars.php (Full HTML Example)

```php
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>htmlspecialchars Example</title>
</head>
<body>
<?php
$str = "We are <a href='https://www.armourinfosec.com/'>Armour Infosec</a>. A knowledge-based and technical security solutions provider.";

// Original string
echo "Original string:<br>" . $str . "<br><br>";

// htmlentities
echo "htmlentities:<br>" . htmlentities($str, ENT_QUOTES, 'UTF-8') . "<br><br>";

// htmlspecialchars
echo "htmlspecialchars:<br>" . htmlspecialchars($str, ENT_QUOTES, 'UTF-8') . "<br><br>";

// Decode htmlspecialchars
echo "After htmlspecialchars decode:<br>" . htmlspecialchars_decode(htmlspecialchars($str, ENT_QUOTES, 'UTF-8'));
?>
</body>
</html>
```

---

## get\_html\_translation\_table.php

```php
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Get HTML Translation Table</title>
</head>
<body>
<h3>HTML_ENTITIES Table</h3>
<pre><?php print_r(get_html_translation_table(HTML_ENTITIES, ENT_QUOTES | ENT_HTML401)); ?></pre>

<h3>HTML_SPECIALCHARS Table</h3>
<pre><?php print_r(get_html_translation_table(HTML_SPECIALCHARS, ENT_QUOTES | ENT_HTML401)); ?></pre>
</body>
</html>
```

---

