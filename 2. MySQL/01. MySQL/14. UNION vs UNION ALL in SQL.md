
## üîÅ `UNION` vs `UNION ALL` in SQL

Both are used to **combine the results of two or more `SELECT` statements**.

---

### üß† Key Differences

| Feature    | `UNION`                       | `UNION ALL`              |
| ---------- | ----------------------------- | ------------------------ |
| Duplicates | ‚ùå Removes duplicates          | ‚úÖ Keeps duplicates       |
| Speed      | Slower (due to deduplication) | Faster                   |
| Use Case   | When you need unique records  | When you need everything |

---

### üîß Requirements (for both)

‚úÖ Same number of columns
‚úÖ Compatible data types (e.g., `INT` with `INT`, `VARCHAR` with `VARCHAR`)
‚úÖ Columns must be in same order

---

## üîç Example Queries

---

### üßæ Basic Table Reads

#### üî∏ Show all rows in `user2`:

```sql
SELECT * FROM user2;
```

#### üî∏ Show all rows in `city`:

```sql
SELECT * FROM city;
```

---

### ‚ùå Invalid: Different column counts

```sql
-- Error: Mismatched column count
SELECT * FROM user2
UNION
SELECT * FROM city;
```

---

### ‚ùå Invalid: Partial vs Full Columns

```sql
-- Error: Left has 2 cols, right has all
SELECT id, name FROM user2
UNION
SELECT * FROM city;
```

---

### ‚úÖ Valid: Matched columns and types

```sql
SELECT id, name FROM user2
UNION
SELECT city_id, city_name FROM city;
```

---

### ‚úÖ Combine names from `user2` and `city`, remove duplicates

```sql
SELECT name FROM user2
UNION
SELECT city_name FROM city;
```

---

### ‚úÖ Same as above but KEEP duplicates

```sql
SELECT name FROM user2
UNION ALL
SELECT city_name FROM city;
```

---

### ‚úÖ Combine IDs from both tables (unique)

```sql
SELECT id FROM user2
UNION
SELECT city_id FROM city;
```

---

### ‚úÖ Combine all IDs, including duplicates

```sql
SELECT id FROM user2
UNION ALL
SELECT city_id FROM city;
```

---

## üéØ Filtered Unions

---

### ‚úÖ Filtered + all records (with `UNION ALL`)

```sql
SELECT id FROM user2 WHERE id < 5
UNION ALL
SELECT city_id FROM city;
```

---

### ‚úÖ user2 with `id < 5` + all cities

```sql
SELECT id, name FROM user2 WHERE id < 5
UNION
SELECT city_id, city_name FROM city;
```

---

### ‚úÖ User with `id = 5` + all cities

```sql
SELECT id, name FROM user2 WHERE id = 5
UNION
SELECT city_id, city_name FROM city;
```

---

### ‚úÖ Both `user2` and `city` with `id = 5`

```sql
SELECT id, name FROM user2 WHERE id = 5
UNION
SELECT city_id, city_name FROM city WHERE city_id = 5;
```

---

## üéì SubQuery + UNION

---

### ‚úÖ Combine filtered and all user2, remove duplicates

```sql
SELECT * FROM user2
WHERE course_name = (
  SELECT course_id FROM course
  WHERE course_name = 'Information Security Expert'
)
UNION
SELECT * FROM user2;
```

---

### ‚ùå Invalid: Columns must match

```sql
-- This will fail: left side has 2 cols, right side has all
SELECT id, name FROM user2
WHERE course_name = (
  SELECT course_id FROM course
  WHERE course_name = 'Information Security Expert'
)
UNION
SELECT * FROM city;
```

---

## üß© Advanced JOIN + UNION

### ‚úÖ Complex JOIN + UNION with raw `user2`

```sql
SELECT u2.id, u2.name, u2.age, u2.gender, u2.email,
       course.course_name, city.city_name
FROM user2 u2
INNER JOIN course ON u2.course_name = course.course_id
INNER JOIN city ON u2.city_name = city.city_id

UNION

SELECT id, name, age, gender, email, NULL AS course_name, NULL AS city_name
FROM user2;
```

> ‚ö†Ô∏è Ensure both `SELECT` blocks return **exact same number of columns**, and **matching data types**.

---

## ‚úÖ TL;DR Cheat Sheet

| Task                                 | Use                |
| ------------------------------------ | ------------------ |
| Merge two queries, remove duplicates | `UNION`            |
| Merge two queries, keep all rows     | `UNION ALL`        |
| Avoid column mismatch errors         | Match count & type |
| Speed boost when dedup isn‚Äôt needed  | `UNION ALL`        |

---

